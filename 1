<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Dastchin — آجیل و خشکبار</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --gold:#c79a2f;        /* طلایی */
    --silver:#bfc2c7;      /* نقره‌ای */
    --cream:#fbf7f1;       /* کرم پس‌زمینه */
    --card:#ffffff;
    --muted:#6b6b6b;
    --shadow: rgba(10,10,10,.06);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;font-family:"Vazirmatn",Tahoma,Arial,sans-serif;background:var(--cream);color:#222;line-height:1.5;-webkit-font-smoothing:antialiased;
  }
  a{color:inherit;text-decoration:none}
  .wrap{max-width:1150px;margin:18px auto;padding:12px}
  /* Header */
  header{display:flex;gap:12px;align-items:center;background:linear-gradient(180deg,#fff, #fff);padding:14px;border-radius:12px;box-shadow:0 10px 30px var(--shadow)}
  .logo{font-weight:800;color:var(--gold);font-size:20px;letter-spacing:.6px}
  .top-actions{margin-left:auto;display:flex;gap:12px;align-items:center}
  .phone{background:linear-gradient(90deg,var(--silver),#fff);padding:8px 12px;border-radius:10px;font-weight:700;color:#111;box-shadow:0 6px 16px var(--shadow)}
  .search{flex:1;display:flex;gap:8px;margin-right:8px}
  .search input{flex:1;padding:10px 12px;border-radius:10px;border:1px solid #eee}
  .search button{padding:10px 14px;border-radius:10px;border:0;background:var(--gold);color:#fff;font-weight:700;cursor:pointer}
  /* nav */
  nav{margin-top:14px;display:flex;gap:10px;flex-wrap:wrap}
  nav a{background:var(--card);padding:8px 12px;border-radius:10px;box-shadow:0 8px 22px var(--shadow);font-weight:600;font-size:14px}
  /* hero */
  .hero{margin-top:16px;background:linear-gradient(90deg,#fff 0%, #fff8e9 100%);padding:18px;border-radius:12px;display:flex;gap:16px;align-items:center}
  .hero .txt h1{margin:0;font-size:22px;color:#2c2c2c}
  .hero .txt p{margin:8px 0;color:var(--muted)}
  .hero img{width:160px;height:120px;object-fit:cover;border-radius:10px;box-shadow:0 10px 30px var(--shadow)}
  /* products */
  .products{display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:14px;margin-top:18px}
  .card{background:var(--card);padding:12px;border-radius:12px;box-shadow:0 10px 30px var(--shadow);display:flex;flex-direction:column;gap:8px;transition:transform .15s}
  .card:hover{transform:translateY(-6px)}
  .card img{width:100%;height:150px;object-fit:cover;border-radius:8px}
  .title{font-weight:700;font-size:15px;color:#222}
  .desc{color:var(--muted);font-size:13px}
  .meta{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:6px}
  .price{font-weight:800;color:var(--gold)}
  .btn{padding:8px 12px;border-radius:10px;border:0;background:var(--gold);color:#fff;font-weight:700;cursor:pointer}
  .btn.ghost{background:transparent;border:1px solid #eee;color:#333}
  /* cart floating */
  .cart-fab{position:fixed;left:18px;bottom:18px;background:linear-gradient(180deg,var(--gold),#a87f18);color:#fff;padding:12px 16px;border-radius:50px;box-shadow:0 18px 50px rgba(0,0,0,.18);z-index:150;display:flex;gap:10px;align-items:center;cursor:pointer}
  .cart-count{background:#fff;color:var(--gold);padding:2px 8px;border-radius:12px;font-weight:800}
  .cart-panel{position:fixed;left:18px;bottom:78px;width:360px;max-height:72vh;overflow:auto;background:var(--card);border-radius:12px;box-shadow:0 30px 80px rgba(0,0,0,.18);padding:12px;z-index:160;display:none}
  .cart-item{display:flex;gap:10px;align-items:center;padding:8px 4px;border-bottom:1px solid #f3f3f3}
  .cart-item img{width:64px;height:64px;object-fit:cover;border-radius:8px}
  .cart-footer{display:flex;justify-content:space-between;align-items:center;padding-top:8px}
  /* modal */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;z-index:220}
  .modal .box{background:var(--card);width:92%;max-width:820px;border-radius:12px;padding:14px;display:flex;gap:12px;align-items:flex-start}
  .modal img{width:44%;height:320px;object-fit:cover;border-radius:10px}
  .modal .info{flex:1}
  /* footer */
  footer{margin-top:28px;padding:18px;border-radius:12px;background:linear-gradient(180deg,#fff,#f7f6f4);box-shadow:0 8px 22px var(--shadow)}
  .trust{display:flex;gap:12px;align-items:center}
  .stars{display:flex;gap:6px}
  .star{width:18px;height:18px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="%23f3c24a" viewBox="0 0 24 24"><path d="M12 .587l3.668 7.431L23.6 9.75l-5.8 5.654L19.335 24 12 19.897 4.665 24l1.535-8.596L0.4 9.75l7.932-1.732z"/></svg>');background-size:contain}
  /* small screens */
  @media (max-width:800px){
    .hero{flex-direction:column;align-items:flex-start}
    .modal .box{flex-direction:column}
    .modal img{width:100%;height:220px}
    .cart-panel{width:92%;left:4%;right:4%}
  }
</style>
</head>
<body>

<div class="wrap">
  <header>
    <div class="logo">Dastchin</div>
    <div class="search">
      <input id="searchInput" placeholder="جستجو محصولات..." aria-label="جستجو">
      <button id="searchBtn">جستجو</button>
    </div>
    <div class="top-actions">
      <div class="phone">09138360115</div>
    </div>
  </header>

  <nav aria-label="دسته‌بندی‌ها">
    <a href="#" onclick="filterCategory('all')">همه محصولات</a>
    <a href="#" onclick="filterCategory('ajil')">آجیل</a>
    <a href="#" onclick="filterCategory('khoshkbar')">خشکبار</a>
    <a href="#" onclick="filterCategory('pishnahad')">پیشنهادها</a>
    <a href="#about">درباره ما</a>
  </nav>

  <section class="hero" aria-hidden="false">
    <div class="txt">
      <h1>آجیل و خشکبار تازه — Dastchin</h1>
      <p>بسته‌بندی بهداشتی — ارسال سریع — انتخاب‌های دست‌چین</p>
      <div style="margin-top:10px">
        <button class="btn" onclick="document.getElementById('products').scrollIntoView({behavior:'smooth'})">مشاهده محصولات</button>
        <a class="btn ghost" href="#contact" style="margin-left:8px">تماس با ما</a>
      </div>
    </div>
    <img src="https://i.postimg.cc/15FYPSkc/1033090-825.jpg" alt="نمونه آجیل">
  </section>

  <main id="products" class="products" aria-live="polite">
    <!-- محصولات با JS اضافه می‌شوند -->
  </main>

  <footer id="about">
    <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px">
      <div>
        <div style="font-weight:800">Dastchin — آجیل و خشکبار</div>
        <div style="color:var(--muted);margin-top:8px">پشتیبانی: 09138360115</div>
      </div>
      <div class="trust">
        <div style="font-weight:700">نشان اعتماد</div>
        <div class="stars" aria-hidden="true">
          <span class="star"></span><span class="star"></span><span class="star"></span><span class="star"></span><span class="star"></span>
        </div>
      </div>
    </div>
  </footer>
</div>

<!-- Cart FAB -->
<button id="openCart" class="cart-fab" aria-label="باز کردن سبد خرید">
  <svg width="18" height="18" viewBox="0 0 24 24" fill="#fff"><path d="M7 4h-2l-1 2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h8v-2h-8l1.1-2h5.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49-1.74-1.01"></path></svg>
  <span style="font-weight:800">سبد خرید</span>
  <span class="cart-count" id="cartCount">0</span>
</button>

<div id="cartPanel" class="cart-panel" aria-hidden="true">
  <div style="font-weight:800;margin-bottom:8px">سبد خرید شما</div>
  <div id="cartItems"></div>
  <div class="cart-footer">
    <div>جمع: <span id="cartTotal">0</span> ت</div>
    <div style="display:flex;gap:8px">
      <button class="btn" id="checkoutBtn">پرداخت</button>
      <button class="btn ghost" id="clearCart">پاک کردن</button>
    </div>
  </div>
</div>

<!-- Modal -->
<div id="productModal" class="modal" aria-hidden="true">
  <div class="box" role="dialog" aria-modal="true">
    <img id="modalImg" src="" alt="تصویر محصول">
    <div class="info">
      <h3 id="modalTitle"></h3>
      <div id="modalDesc" style="color:var(--muted);margin-top:8px"></div>
      <div style="margin-top:12px;font-size:18px;color:var(--gold)" id="modalPrice">0 ت</div>
      <div style="margin-top:14px">
        <button class="btn" id="modalAdd">افزودن به سبد</button>
        <button class="btn ghost" id="modalClose">بستن</button>
      </div>
    </div>
  </div>
</div>

<script>
/* ============ دادهٔ نمونه محصولات ============
   می‌تونی این آرایه را با محصولات واقعی خودت جایگزین کنی.
   هر محصول: id, title, price (تومان عددی), image, desc, category
*/
const PRODUCTS = [
  {id:1,title:"آجیل مخلوط ممتاز 450 گرم",price:125000,image:"https://i.postimg.cc/15FYPSkc/1033090-825.jpg",desc:"مخلوطی از پسته، بادام، فندق و کشمش - تازه و دستچین",category:"ajil"},
  {id:2,title:"پسته اکبری 250 گرم",price:240000,image:"https://i.postimg.cc/7YqvQ7zS/pistachio.jpg",desc:"پسته خوش‌طعم و تازه مناسب هدیه",category:"ajil"},
  {id:3,title:"مغز بادام خام 300 گرم",price:180000,image:"https://i.postimg.cc/9Q1dQG2w/almond.jpg",desc:"بادام ایرانی با کیفیت بالا",category:"khoshkbar"},
  {id:4,title:"گردو تازه 400 گرم",price:140000,image:"https://i.postimg.cc/6qj8Y1Dk/walnut.jpg",desc:"گردو مرغوب شکسته برای مصرف روزانه",category:"khoshkbar"},
  {id:5,title:"برگه زردآلو 200 گرم",price:75000,image:"https://i.postimg.cc/Gt2n6Yy3/apricot.jpg",desc:"برگه طبیعی بدون مواد افزودنی",category:"khoshkbar"},
  {id:6,title:"کشمش طلایی 300 گرم",price:65000,image:"https://i.postimg.cc/4NjQmK2L/raisin.jpg",desc:"کشمش رنگی و شیرین برای صبحانه",category:"khoshkbar"}
];

/* ============ رندر محصولات ============ */
const productsEl = document.getElementById('products');

function renderProductCard(p){
  const div = document.createElement('div');
  div.className = 'card';
  div.innerHTML = `
    <img src="${p.image}" alt="${p.title}" loading="lazy">
    <div class="title">${p.title}</div>
    <div class="desc">${p.desc}</div>
    <div class="meta">
      <div class="price">${p.price.toLocaleString()} ت</div>
      <div>
        <button class="btn" data-add="${p.id}">افزودن</button>
        <button class="btn ghost" data-view="${p.id}">مشاهده</button>
      </div>
    </div>
  `;
  return div;
}

function renderProducts(list = PRODUCTS){
  productsEl.innerHTML = '';
  if(!list.length) { productsEl.innerHTML = '<div style="padding:12px;color:var(--muted)">محصولی یافت نشد.</div>'; return; }
  list.forEach(p=> productsEl.appendChild(renderProductCard(p)));
}
renderProducts();

/* ============ فیلتر و جستجو ============ */
function filterCategory(cat){
  if(cat === 'all'){ renderProducts(); return; }
  renderProducts(PRODUCTS.filter(p=>p.category === cat));
}
document.getElementById('searchBtn').addEventListener('click', ()=>{
  const q = document.getElementById('searchInput').value.trim().toLowerCase();
  if(!q) return renderProducts();
  const res = PRODUCTS.filter(p => (p.title + ' ' + p.desc).toLowerCase().includes(q));
  renderProducts(res);
});

/* ============ cart (localStorage) ============ */
const CART_KEY = 'dastchin_cart_v1';
function loadCart(){ try { return JSON.parse(localStorage.getItem(CART_KEY)) || []; } catch(e){ return []; } }
function saveCart(cart){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); renderCart(); }
function addToCart(id, qty=1){
  const cart = loadCart();
  const found = cart.find(i=>i.id===id);
  if(found) found.qty += qty; else cart.push({id:id,qty:qty});
  saveCart(cart);
}
function removeFromCart(id){
  let cart = loadCart(); cart = cart.filter(i=>i.id!==id); saveCart(cart);
}
function clearCart(){ localStorage.removeItem(CART_KEY); renderCart(); }

/* render cart */
const cartPanel = document.getElementById('cartPanel');
const cartItemsEl = document.getElementById('cartItems');
const cartCountEl = document.getElementById('cartCount');
const cartTotalEl = document.getElementById('cartTotal');

function renderCart(){
  const cart = loadCart();
  cartItemsEl.innerHTML = '';
  let total = 0, count = 0;
  if(!cart.length){
    cartItemsEl.innerHTML = '<div style="color:var(--muted);padding:8px">سبد خرید خالی است.</div>';
  } else {
    cart.forEach(item=>{
      const p = PRODUCTS.find(x=>x.id===item.id);
      if(!p) return;
      const div = document.createElement('div');
      div.className = 'cart-item';
      div.innerHTML = `
        <img src="${p.image}" alt="${p.title}">
        <div style="flex:1">
          <div style="font-weight:700">${p.title}</div>
          <div style="color:var(--muted);font-size:13px">تعداد: ${item.qty}</div>
        </div>
        <div style="text-align:left">
          <div style="font-weight:800">${(p.price*item.qty).toLocaleString()} ت</div>
          <div style="margin-top:6px">
            <button class="btn ghost" data-remove="${p.id}">حذف</button>
          </div>
        </div>
      `;
      cartItemsEl.appendChild(div);
      total += p.price * item.qty;
      count += item.qty;
    });
  }
  cartCountEl.textContent = count;
  cartTotalEl.textContent = total.toLocaleString();
}

/* open/close cart */
document.getElementById('openCart').addEventListener('click', ()=>{
  cartPanel.style.display = cartPanel.style.display === 'block' ? 'none' : 'block';
  renderCart();
});

/* event delegation for add/view/remove */
document.body.addEventListener('click', (e)=>{
  const add = e.target.closest('[data-add]');
  if(add){ addToCart(parseInt(add.getAttribute('data-add'))); renderCart(); return; }
  const view = e.target.closest('[data-view]');
  if(view){ openModal(parseInt(view.getAttribute('data-view'))); return; }
  const rem = e.target.closest('[data-remove]');
  if(rem){ removeFromCart(parseInt(rem.getAttribute('data-remove'))); return; }
});

/* clear cart */
document.getElementById('clearCart').addEventListener('click', clearCart);

/* checkout — جای لینک درگاه را اینجا قرار بده */
document.getElementById('checkoutBtn').addEventListener('click', ()=>{
  const cart = loadCart();
  if(!cart.length){ alert('سبد خرید خالی است'); return; }
  let total = 0; cart.forEach(i=>{ const p = PRODUCTS.find(x=>x.id===i.id); if(p) total += p.price * i.qty; });
  // اگر درگاه آنلاین دارید: مقدار PAYMENT_LINK را در کد تغییر دهید.
  const PAYMENT_LINK = "PAYMENT_LINK"; // <-- این را با آدرس درگاه خودت جایگزین کن
  if(PAYMENT_LINK && PAYMENT_LINK !== "PAYMENT_LINK"){
    // نمونه: ارسال پارامتر مبلغ به درگاه (بستگی به درگاه دارد)
    window.open(PAYMENT_LINK, '_blank');
  } else {
    alert('لطفاً لینک درگاه پرداخت را در کد تنظیم کنید. (مبلغ: ' + total.toLocaleString() + ' ت)');
  }
});

/* ============ modal product ============ */
const modal = document.getElementById('productModal');
const modalImg = document.getElementById('modalImg');
const modalTitle = document.getElementById('modalTitle');
const modalDesc = document.getElementById('modalDesc');
const modalPrice = document.getElementById('modalPrice');
const modalAdd = document.getElementById('modalAdd');

function openModal(id){
  const p = PRODUCTS.find(x=>x.id===id);
  if(!p) return;
  modalImg.src = p.image;
  modalTitle.textContent = p.title;
  modalDesc.textContent = p.desc;
  modalPrice.textContent = p.price.toLocaleString() + ' ت';
  modal.style.display = 'flex';
  modalAdd.onclick = ()=>{ addToCart(p.id); renderCart(); modal.style.display = 'none'; };
}
document.getElementById('modalClose').addEventListener('click', ()=> modal.style.display = 'none');
modal.addEventListener('click', (e)=>{ if(e.target === modal) modal.style.display = 'none'; });

/* init cart render */
renderCart();
</script>
</body>
</html>
